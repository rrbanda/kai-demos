schemaVersion: 2.2.0
metadata:
  name: kai-devspaces
  version: 1.0.0
  displayName: Kai DevSpaces with code-server
  description: Custom image with Kai dependencies, code-server, and Konveyor plugin
  tags:
    - vscode
    - konveyor
    - kai
    - devspaces
attributes:
  controller.devfile.io/storage-type: per-workspace

components:
  - name: kai-dev-tools
    container:
      image: quay.io/rbrhssa/kai-devspaces:latest
      memoryLimit: 4Gi
      mountSources: true
      sourceMapping: /projects
      command: ["code-server"]
      env:
        - name: PASSWORD
          value: devspaces  # Optional: password for code-server

commands:
  - id: open-code-server
    exec:
      label: "Start code-server"
      component: kai-dev-tools
      commandLine: "code-server --host 0.0.0.0 --port 8080"
      workingDir: /projects
      group:
        kind: run
        isDefault: true
